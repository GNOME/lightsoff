#!/usr/bin/env seed

file_prefix = '@prefix@' + "/share/gnome-games/lightsoff/";
imports.searchPath.unshift(file_prefix);

GtkClutter = imports.gi.GtkClutter;
Clutter = imports.gi.Clutter;
Gtk = imports.gi.Gtk;
GtkBuilder = imports.gtkbuilder;

GtkClutter.init(Seed.argv);

Game = imports.Game;
Settings = imports.Settings;

handlers = {
	show_settings: function(selector, ud)
	{
		Settings.show_settings();
	}
};

b = new Gtk.Builder();
b.add_from_file(file_prefix + "/main-window.ui");
b.connect_signals(handlers);

var window = b.get_object("window1");
var clutter_embed = new GtkClutter.Embed();
window.signal.hide.connect(Gtk.main_quit);
b.get_object("vbox1").pack_start(clutter_embed, true, true);

var stage = clutter_embed.get_stage();
stage.color = {alpha:255};

Settings.theme.map_stuff(stage);

var game = new Game.GameView();
stage.add_actor(game);
stage.set_size(game.width, game.height);
clutter_embed.set_size_request(stage.width, stage.height);

stage.show_all();
window.show_all();

Gtk.main();
